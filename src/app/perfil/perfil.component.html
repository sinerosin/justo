<ion-split-pane contentId="main-content">
  <ion-menu contentId="main-content" type="overlay">
    <ion-content class="sidebar-content">
      <div class="brand-section">
        <span class="material-symbols-outlined neon-text">deployed_code</span>
        <div>
          <h3>BETSTARS</h3>
        </div>
      </div>

      <ion-list lines="none" class="menu-list">
        <ion-item button (click)="navigateTo('/home')" >
          <span class="material-symbols-outlined" slot="start">dashboard</span>
          <ion-label>PANEL</ion-label>
        </ion-item>
        <ion-item button (click)="navigateTo('/liga')">
          <span class="material-symbols-outlined" slot="start">military_tech</span>
          <ion-label>LIGA</ion-label>
        </ion-item>
        <ion-item button (click)="navigateTo('/ranking')">
          <span class="material-symbols-outlined" slot="start">leaderboard</span>
          <ion-label>RANKING</ion-label>
        </ion-item>
        <ion-item button (click)="navigateTo('/perfil')"class="active-item">
          <span class="material-symbols-outlined" slot="start">person</span>
          <ion-label>PERFIL</ion-label>
        </ion-item>
        <ion-item button (click)="navigateTo('/historial')" >
          <span class="material-symbols-outlined" slot="start">history</span>
          <ion-label>HISTORIAL</ion-label>
        </ion-item>
      </ion-list>

      <div class="sidebar-footer">
        <ion-item lines="none" class="user-item">
          <div slot="start" class="avatar-sidebar">
            <span class="material-symbols-outlined">{{ currentUser.avatar || 'account_circle' }}</span>
          </div>
          <ion-label>
            <h2>{{ currentUser.username }}</h2>
          </ion-label>
        </ion-item>
        <ion-button expand="block" fill="outline" class="logout-btn" (click)="logout()">
          <span class="material-symbols-outlined" slot="start">logout</span>
          LOGOUT
        </ion-button>
      </div>
    </ion-content>
  </ion-menu>

  <div class="ion-page" id="main-content">
    <ion-header class="ion-no-border">
      <ion-toolbar color="black">
        <ion-buttons slot="start"><ion-menu-button color="danger"></ion-menu-button></ion-buttons>
        <div class="header-title-group">
          <ion-title>Configuración de Perfil</ion-title>
          <small>PERSONALIZA TU CUENTA</small>
        </div>
        <ion-badge slot="end" class="pts-badge">{{ currentUser.points }} PTS</ion-badge>
      </ion-toolbar>
    </ion-header>

    <ion-content class="dark-theme">
      <div class="profile-wrapper">
        
        <ion-card class="profile-info-card">
          <div class="avatar-large">
            <span class="material-symbols-outlined" style="font-size: 60px;">{{ selectedAvatar }}</span>
          </div>
          <div class="user-meta">
            <h2>{{ currentUser.username }}</h2>
            <p>MIEMBRO DESDE 2026</p>
          </div>
        </ion-card>

        <ion-card class="details-card">
          <div class="card-header">
            <ion-icon name="person-outline" color="danger"></ion-icon>
            <h3>Detalles Públicos</h3>
          </div>

          <ion-card-content>
            <div class="input-group">
              <ion-label>NOMBRE DE USUARIO</ion-label>
              <ion-item class="custom-input" lines="none">
                <ion-icon name="id-card-outline" slot="start"></ion-icon>
                <ion-input [(ngModel)]="newUsername" placeholder="Tu nombre"></ion-input>
              </ion-item>
            </div>

            <div class="avatar-selector-section">
              <ion-label>CAMBIAR ICONO DE AVATAR</ion-label>
              <div class="icon-grid">
                <div *ngFor="let icon of avatarOptions" 
                     class="icon-option" 
                     [class.active]="selectedAvatar === icon"
                     (click)="selectAvatar(icon)">
                  <span class="material-symbols-outlined">{{ icon }}</span>
                </div>
              </div>
            </div>

            <ion-button expand="block" color="danger" class="save-button" (click)="saveChanges()">
              <ion-icon slot="start" name="save-outline"></ion-icon>
              Confirmar Cambios
            </ion-button>
          </ion-card-content>
        </ion-card>

      </div>
    </ion-content>
  </div>
</ion-split-pane>